"use strict";(self.webpackChunkdevto_clone_client=self.webpackChunkdevto_clone_client||[]).push([[238],{9124:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(5861),s=n(9439),o=n(7757),c=n.n(o),a=n(2791),i=n(8241),l=n(1742),u=n(6545),d=n(2703),m=n(184),h=function(e){var t=e.followId,n=e.setShowModal,o=e.followers,h=e.userToFollow,p=(0,a.useContext)(i.V).currentUser,x=(0,a.useContext)(l.J).socket.current,f=p&&p.userId,v=(0,u.Z)().sendReq,j=(0,a.useState)(!1),k=(0,s.Z)(j,2),_=k[0],C=k[1];(0,a.useEffect)((function(){C((0,d.nH)(o,f))}),[o,f]);var b=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_?"unfollow":"follow",C((function(e){return!e})),"follow"===n&&x.emit("follow",{sender:p,receiver:h}),r={userId:f,followId:t},e.prev=4,e.next=7,v("".concat("https://devfrom.herokuapp.com/api","/users/").concat(n),"PUT",JSON.stringify(r),{Authorization:"Bearer ".concat(p.token),"Content-Type":"application/json"});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsx)("button",{className:"btn--profile-cta ".concat(_?"btn-following":""),onClick:function(){f?b(t):n(!0)},children:_?"Following":"Follow"})}},8238:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var r=n(5861),s=n(9439),o=n(7757),c=n.n(o),a=n(2791),i=n(6545),l=n(9271),u=n(8241),d=n(5547),m=n(184),h=function(e){var t=e.likes,n=e.handleReaction,r=e.isLiked,s=e.setShowModal,o=(0,a.useContext)(u.V).currentUser,c=o&&o.userId,i=r?"unlike":"like",l=r?"negative":"positive";return(0,m.jsxs)("div",{className:"".concat(r?"reactions__block clicked--like":"reactions__block"),children:[(0,m.jsx)("i",{onClick:function(){c?n(i,l,t,"isLiked"):s(!0)},className:"".concat(r?"reactions__like reactions__liked":"reactions__like"),children:(0,m.jsx)(d.l,{state:r,size:"2.5rem"})}),(0,m.jsx)("span",{children:t&&t.length})]})},p=n(2936),x=function(e){var t=e.unicorns,n=e.isUnicorned,r=e.handleReaction,s=e.setShowModal,o=(0,a.useContext)(u.V).currentUser,c=o&&o.userId,i=n?"ununicorn":"unicorn",l=n?"negative":"positive";return(0,m.jsxs)("div",{className:"".concat(n?"reactions__block clicked--unicorn":"reactions__block "),children:[(0,m.jsx)("i",{onClick:function(){c?r(i,l,t,"isUnicorned"):s(!0)},className:"".concat(n?"reactions__unicorn reactions__unicorned":"reactions__unicorn"),children:(0,m.jsx)(p.y,{size:"2.5rem"})}),(0,m.jsx)("span",{children:t&&t.length})]})},f=function(e){var t=e.bookmarks,n=e.isBookmarked,r=e.handleReaction,s=e.setShowModal,o=(e.id,e.children,(0,a.useContext)(u.V).currentUser),c=o&&o.userId,i=n?"unbookmark":"bookmark",l=n?"negative":"positive";return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"".concat(n?"reactions__block clicked--bookmark":"reactions__block "),children:[(0,m.jsx)("i",{onClick:function(){c?r(i,l,t,"isBookmarked"):s(!0)},className:"".concat(n?"reactions__save reactions__saved":"reactions__save"),children:(0,m.jsx)(d.p,{state:n,size:"2.5rem"})}),(0,m.jsx)("span",{children:t&&t.length})]})})},v=n(1629),j=function(e){var t=e.post,n=e.setShowModal,r=(e.handleInteraction,t.likes),s=t.unicorns,o=t.bookmarks,c=t.id,a=t.author,i=(0,v.Z)(r,s,o,c,a),l=i.state,u=i.handleReaction,d=l.isLiked,p=l.isUnicorned,j=l.isBookmarked;return(0,m.jsxs)("div",{className:"post__reactions",children:[(0,m.jsx)(h,{likes:r,isLiked:d,setShowModal:n,handleReaction:u}),(0,m.jsx)(x,{unicorns:s,isUnicorned:p,setShowModal:n,handleReaction:u}),(0,m.jsx)(f,{bookmarks:o,isBookmarked:j,setShowModal:n,handleReaction:u})]})},k=n(1523),_=n(8784),C=n(4030),b=n(2703),w=n(6191),I=n(5440),N=function(e){var t=e.currentUserId,n=e.comment,r=e.setShowModal,s=(0,a.useContext)(F).setActiveComment;return(0,m.jsxs)("button",{className:"btn comments__total",onClick:function(){(0,b.BV)(t)?s({id:n.id,type:"replying"}):r(!0)},children:[(0,m.jsx)("i",{children:(0,m.jsx)(I.Z,{size:"2rem"})}),(0,m.jsx)("span",{className:"reactions__text",children:"Reply"})]})},y=function(e){var t=e.currentUserId,n=e.commentId,r=e.authorId,s=(0,a.useContext)(F).setActiveComment;return(0,m.jsx)(m.Fragment,{children:(0,b.Rj)(t,r)&&(0,m.jsx)("button",{className:"btn auth__edit",onClick:function(){return s({id:n,type:"editing"})},children:"Edit"})})},g=n(441),Z=function(e){var t=e.handleLike,n=e.isLiked,r=e.likes;return(0,m.jsxs)("button",{className:"btn comments__total ".concat(n&&"comment__liked"),onClick:t,children:[(0,m.jsx)("i",{className:"like-comment-icon",children:(0,m.jsx)(d.l,{state:n,size:"2rem"})}),(0,m.jsxs)("span",{children:[r&&r.length,(0,m.jsx)("span",{className:"reactions__text",children:"likes"})]})]})},S=function(e){var t=e.likes,n=e.commentId,o=e.setShowModal,l=(0,a.useContext)(u.V).currentUser,d=l&&l.userId,h=(0,i.Z)(),p=h.sendReq,x=h.error,f=h.clearError,v=(0,a.useState)((0,b.nH)(t,d)),j=(0,s.Z)(v,2),k=j[0],_=j[1],C=function(){var e=(0,r.Z)(c().mark((function e(){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=3;break}return o(!0),e.abrupt("return");case 3:return"unlike"===(r=(0,b.nH)(t,d)?"unlike":"like")?t.splice(t.indexOf(d),1):t.push(d),_((function(e){return!e})),e.prev=6,e.next=9,p("".concat("https://devfrom.herokuapp.com/api","/comments/").concat(n,"/").concat(r),"PUT",JSON.stringify({userId:l.userId,commentId:n}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(l.token)});case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(6);case 13:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g.Z,{error:x,onClose:f}),(0,m.jsx)(Z,{handleLike:C,isLiked:k,likes:t})]})},U=n(1413),R=function(e){var t=e.handleSubmit,n=e.submitLabel,o=e.hasCancelButton,i=void 0!==o&&o,l=e.initialText,d=void 0===l?"":l,h=e.handleCancel,p=e.avatar,x=(0,a.useContext)(u.V).currentUser,f=(0,a.useState)(d),v=(0,s.Z)(f,2),j=v[0],k=v[1],_=0===j.length,b=function(){var e=(0,r.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t(j),k("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)("div",{className:"comment-form ".concat("Reply"===n&&"reply-form"),children:[p&&(0,m.jsx)(C.Z,{src:x&&x.avatar?x.avatar:"https://res.cloudinary.com/drkvr9wta/image/upload/v1647701003/undraw_profile_pic_ic5t_ncxyyo.png"}),(0,m.jsxs)("form",{onSubmit:b,children:[(0,m.jsx)("input",{type:"textarea",placeholder:"Add to the discussion",name:"comment",value:j,onChange:function(e){e.persist(),k(e.target.value)}}),(0,m.jsxs)("div",{className:"comments__btn",children:[j&&(0,m.jsx)("button",{className:"btn btn--comment",disabled:_,children:n}),i&&(0,m.jsx)("button",{className:"btn btn--dismiss",type:"button",onClick:h,children:"Dismiss"})]})]})]})},A=function(e){var t=e.commentId,n=e.commentBody,s=(e.setShowModal,(0,a.useContext)(F)),o=s.setActiveComment,l=s.comments,d=s.setComments,h=(0,a.useContext)(u.V).currentUser,p=(0,i.Z)(),x=p.sendReq,f=p.error,v=p.clearError,j=function(){var e=(0,r.Z)(c().mark((function e(t,n){var r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.map((function(e){return e.id===n?(0,U.Z)((0,U.Z)({},e),{},{body:t}):e})),e.prev=1,e.next=4,x("".concat("https://devfrom.herokuapp.com/api","/comments/").concat(n),"PATCH",JSON.stringify({body:t,author:h.userId}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(h.token)});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:d(r),o(null);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g.Z,{error:f,onClose:v}),(0,m.jsx)(R,{submitLabel:"Edit comment",hasCancelButton:!0,initialText:n,handleSubmit:function(e){return j(e,t)},handleCancel:function(){return o(null)}})]})},E=n(3433),L=n(1742),M=function(e){var t=e.replyId,n=(0,a.useContext)(F),s=n.setActiveComment,o=n.setComments,l=n.postId,d=n.postAuthor,h=(0,a.useContext)(u.V).currentUser,p=(0,a.useContext)(L.J).socket,x=(0,i.Z)(),f=x.sendReq,v=x.error,j=x.clearError,k=h&&h.userId,_=function(){var e=(0,r.Z)(c().mark((function e(t){var n,r,a,i=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:null,r={parentPost:l,body:t,author:k,parentId:n,userId:k},e.prev=2,e.next=5,f("".concat("https://devfrom.herokuapp.com/api","/comments"),"POST",JSON.stringify(r),{Authorization:"Bearer ".concat(h.token),"Content-Type":"application/json"});case 5:a=e.sent,o((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[a.comment].concat((0,E.Z)(e))})),p.current&&p.current.emit("comment",{sender:h,postId:l,receiver:d}),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:s(null);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g.Z,{error:v,onClose:j}),(0,m.jsx)(R,{avatar:!t,handleSubmit:function(e){return _(e,t&&t)},submitLabel:t?"Reply":"Submit",handleCancel:function(){return s(null)}})]})},B=function(e){var t=e.currentUserId,n=e.commentId,r=e.authorId,s=e.deleteComment;return(0,m.jsx)(m.Fragment,{children:(0,b.Rj)(t,r)&&(0,m.jsx)("button",{className:"btn auth__delete comment__auth",onClick:function(){return s(n)},children:"Delete"})})},T=function(e){var t=e.commentId,n=e.authorId,s=(0,a.useContext)(F),o=s.setActiveComment,l=s.comments,d=s.setComments,h=(0,a.useContext)(u.V).currentUser,p=h&&h.userId,x=(0,i.Z)(),f=x.sendReq,v=x.error,j=x.clearError,k=function(){var e=(0,r.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.filter((function(e){return e.id!==t})),e.prev=1,e.next=4,f("".concat("https://devfrom.herokuapp.com/api","/comments/").concat(t),"DELETE",JSON.stringify({author:p}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(h.token)});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:d(n),o(null);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g.Z,{error:v,onClose:j}),(0,m.jsx)(B,{currentUserId:p,commentId:t,authorId:n,deleteComment:k})]})},D=function e(t){var n=t.comment,r=t.replies,o=t.parentId,c=void 0===o?null:o,i=t.currentUserId,l=(0,a.useContext)(F).activeComment,u=(0,a.useState)(!1),d=(0,s.Z)(u,2),h=d[0],p=d[1],x=(0,b.p6)(n.date);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:"container-comment",children:[(0,m.jsx)(C.Z,{className:"author__image--comment",src:"".concat(n.author.avatar)}),(0,m.jsxs)("div",{className:"comment",children:[(0,m.jsxs)("div",{className:"comment__content",children:[(0,m.jsxs)("div",{className:"comment__meta",children:[(0,m.jsx)("div",{className:"comment__author",children:n.author.name}),(0,m.jsx)("span",{children:x})]}),(0,b.ny)(l,n.id)?(0,m.jsx)(A,{commentId:n.id,commentBody:n.body,setShowModal:p}):(0,m.jsx)("div",{className:"comment__body",children:n.body})]}),(0,m.jsx)(w.Z,{onClose:function(){return p(!1)},show:h}),(0,m.jsxs)("div",{className:"preview__reactions",children:[(0,m.jsxs)("div",{className:"preview__reactions--left",children:[(0,m.jsx)(S,{likes:n.likes,commentId:n.id,setShowModal:p}),(0,m.jsx)(N,{currentUserId:i,comment:n,setShowModal:p})]}),(0,m.jsxs)("div",{className:"preview__reactions--right",children:[(0,m.jsx)(y,{currentUserId:i,commentId:n.id,authorId:n.author.id}),(0,m.jsx)(T,{commentId:n.id,authorId:n.author.id})]})]})]})]}),(0,b.vB)(l,n.id)&&(0,m.jsx)(M,{replyId:c||n.id}),(0,m.jsx)("div",{className:"replies",style:{marginLeft:"5rem"},children:r.length>0&&r.map((function(t){return(0,m.jsx)(e,{comment:t,replies:[],parentId:n.id,currentUserId:i},t._id)}))})]})},F=(0,a.createContext)(),V=function(e){var t=e.postAuthor,n=e.postId,o=(0,a.useContext)(u.V).currentUser,l=o&&o.userId,d=(0,a.useState)(null),h=(0,s.Z)(d,2),p=h[0],x=h[1],f=(0,a.useState)([]),v=(0,s.Z)(f,2),j=v[0],k=v[1],_=j&&j.filter((function(e){return e&&!e.parentId})),C=(0,i.x)(),w=C.sendReq,I=C.error,N=C.clearError;return(0,a.useEffect)((function(){var e=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w("".concat("https://devfrom.herokuapp.com/api","/comments/").concat(n));case 3:t=e.sent,k(t.comments),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[w,n]),(0,m.jsxs)(F.Provider,{value:{comments:j,setComments:k,postId:n,postAuthor:t,activeComment:p,setActiveComment:x},children:[(0,m.jsx)(g.Z,{error:I,onClose:N}),(0,m.jsxs)("div",{className:"comments",children:[(0,m.jsx)("h2",{children:"Discussion (".concat(j?"".concat(j.length," comments"):0,")")}),(0,m.jsx)(M,{}),_&&_.map((function(e){return(0,m.jsx)(D,{comment:e,replies:(0,b.$m)(j,e._id),parentId:e.parentId,currentUserId:l},e._id)}))]})]})},z=n(542),P=n(939),O=function(e){return(0,m.jsx)(P.Z,{title:"Are you sure?",show:e.show,onClose:e.onClose,footer:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("button",{onClick:e.cancelDeleteHandler,className:"btn btn--cancel",children:"Cancel"}),(0,m.jsx)("button",{onClick:e.confirmDeleteHandler,className:"btn btn--delete",children:"Delete"})]}),children:(0,m.jsx)("p",{children:"Do you want to proceed and delete this post? Please note that this action can't be undone!"})})},q=function(e){var t=e.authorId,n=(0,i.Z)(),o=n.sendReq,l=n.error,d=n.clearError,h=(0,z.k6)(),p=(0,z.UO)(),x=p.titleURL,f=p.postId,v=(0,a.useContext)(u.V).currentUser,j=v&&v.userId,k=(0,a.useState)(!1),_=(0,s.Z)(k,2),C=_[0],b=_[1],w=function(){var e=(0,r.Z)(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o("".concat("https://devfrom.herokuapp.com/api","/posts/").concat(x,"/").concat(f),"DELETE",JSON.stringify({author:j}),{"Content-Type":"application/json",Authorization:"Bearer ".concat(v.token)});case 3:h.push("/"),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(g.Z,{error:l,onClose:d}),(0,m.jsx)(O,{onClose:function(){return b(!1)},show:C,cancelDeleteHandler:function(){b(!1)},confirmDeleteHandler:function(){w()}}),j===t&&(0,m.jsx)("button",{className:"btn auth__delete",onClick:function(){b(!0)},children:"Delete Post"})]})},H=n(8662),J=n(6057),$=function(e){var t=e.post,n=(e.handleDelete,t.image),r=t.imgAlt,s=t.author,o=t.titleURL,c=t.date,i=t.title,l=t.tags,d=t.body,h=t.id,p=(0,b.p6)(c),x=(0,a.useContext)(u.V).currentUser,f=x&&x.userId;return(0,m.jsxs)("div",{className:"post",children:[(0,m.jsx)(J.N,{src:n,alt:r}),(0,m.jsxs)("div",{className:"post__body",children:[(0,m.jsxs)("div",{className:"post__author",children:[(0,m.jsx)(C.Z,{link:"/users/".concat(s.id),src:s.avatar}),(0,m.jsxs)("div",{className:"author__details",children:[(0,m.jsx)(k.rU,{to:"/users/".concat(s.id),children:(0,m.jsx)("h4",{children:s.name})}),(0,m.jsx)("p",{children:p})]})]}),(0,m.jsx)("h1",{className:"post__heading",children:i}),(0,m.jsx)(H.w,{tags:l}),(0,m.jsx)("div",{className:"post__text",children:(0,m.jsx)(_.D,{children:d})}),(0,m.jsxs)("div",{className:"post__auth",children:[f===s.id&&(0,m.jsx)(k.rU,{className:"auth__edit",to:"/posts/".concat(o,"/").concat(h,"/edit"),children:"Edit Post"}),(0,m.jsx)(q,{authorId:s.id})]})]}),t.comments&&(0,m.jsx)(V,{postId:h,postAuthor:s})]})},G=n(9124),K=n(5501),Q=function(e){var t=e.setShowModal,n=e.author,r=(0,a.useContext)(u.V).currentUser,s=r&&r.userId;return(0,m.jsxs)("div",{className:"author flow-content",children:[(0,m.jsxs)("div",{className:"author__content",children:[(0,m.jsx)(C.Z,{link:"/users/".concat(n.id),src:n.avatar}),(0,m.jsx)("div",{className:"author__details",children:(0,m.jsx)("h3",{children:n.name})})]}),s===n.id?(0,m.jsx)(k.rU,{className:"btn btn--profile-cta btn--profile-edit",to:"/users/".concat(n.id,"/edit"),children:"Edit Profile"}):(0,m.jsx)(G.Z,{followId:n.id,setShowModal:t,followers:n.followers,userToFollow:n}),(0,m.jsx)(K.d,{author:n})]})},W=n(4132),X=function(e){var t=(0,a.useState)({}),n=(0,s.Z)(t,2),o=n[0],u=n[1],d=(0,i.x)(),h=d.isLoading,p=d.sendReq,x=d.error,f=d.clearError,v=(0,l.useParams)(),k=v.postId,_=v.titleURL,C=(0,a.useState)(!1),b=(0,s.Z)(C,2),I=b[0],N=b[1],y=o.author;return(0,a.useEffect)((function(){var e=function(){var e=(0,r.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p("".concat("https://devfrom.herokuapp.com/api","/posts/").concat(_,"/").concat(k));case 3:t=e.sent,u(t.post),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[p,k,_]),(0,m.jsxs)(m.Fragment,{children:[h&&(0,m.jsx)(W.Z,{asOverlay:!0}),(0,m.jsx)(g.Z,{error:x,onClose:f}),!h&&o.author&&(0,m.jsxs)("div",{className:"container-layout-post",children:[(0,m.jsx)(j,{post:o,setShowModal:N}),(0,m.jsx)(w.Z,{onClose:function(){return N(!1)},show:I}),(0,m.jsxs)("div",{className:"container-post",children:[(0,m.jsx)($,{post:o}),(0,m.jsx)(Q,{setShowModal:N,author:y})]})]})]})}}}]);
//# sourceMappingURL=238.ccc1139a.chunk.js.map